v3.2.2
======

LTE check
---------

Make sure that the LTE stick is properly setup and that PIN verification is disabled.

Docker container setup
----------------------
.. code-block:: sh

   git clone git@github.com:BeagleSystems/monorepo
   cd monorepo
   git submodule update --init --recursive

Also need access to docker_registry server as in 

:ref:`_docker-registry-label <./docker_registry.rst>`

Pull the docker images from docker registery

.. code-block:: sh

   cd releases
   docker-compose pull

Start the docker images after Pull

.. code-block:: sh

   docker-compose up -d
   docker ps

Redis configuration
-------------------

Go to the redis UI page for the drone (e.g. http://10.8.2.42:7843/ for M10)

Set `root:version:set` to the latest version, e.g. `3.2.2`

Refresh the redis UI until `root:version:current` is also the latest version.

Set `root:vehicle_name` to the corresponding drone name, e.g. `M10`.


Payload configuration v3.2.2
----------------------------

Let's start with the FPV camera. We set `root:payload:configuration` to the following,
which works for both IMX219 and IMX477.

.. code-block:: json

   {
       "cam0": {
           "type": "fpv",
           "enabled": true,
           "mavlink_com_id": 101,
           "flip": false,
           "stream": {
               "bitrate": 200000,
               "sensor_id": 0,
               "framerate": 30,
               "stream_height": 1080,
               "stream_width": 1920,
               "gcs_port": 5601,
               "type": "argus",
               "allow_broadcast": true,
               "allow_record": false,
               "record_udp_port": 40100,
               "broadcast_address": "10.8.1.68",
               "broadcast_port": 5810
           }
       }
   }

The broadcast_port has to be manually adjusted for every single drone and every single video stream.
The allowed broadcast ports for each drone can be found in the notion page for the drone under the
`Broadcast ports` property. For example: https://www.notion.so/beagleboard/M10-fe3bf124348c4b8ca964bc74733a03ad

Supported payloads:

1. Sony ILX-LR1: :ref:`sony_ilxlr1-label`
2. Nighthawk Trip6: :ref:`nighthawk_trip6-label`
